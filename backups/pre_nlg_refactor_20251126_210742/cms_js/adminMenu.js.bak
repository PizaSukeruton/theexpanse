// Admin Menu System for CMS

window.showAdminMenu = () => {
    const leftPanel = document.getElementById('character-list-container');

    leftPanel.innerHTML = `
        <div class="admin-menu">
            <div class="menu-section">
                <h3 class="menu-header">CHARACTER MANAGEMENT</h3>
                <button class="menu-button" onclick="loadCharacterList()">View All Characters</button>
                <button class="menu-button" onclick="showCreateCharacter()">Create New Character</button>
                <button class="menu-button" onclick="showEditCharacter()">Edit Character</button>
                <button class="menu-button" onclick="showInventoryManager()">Character Inventory</button>
                <button class="menu-button" onclick="showTraitsManager()">Traits & PAD Values</button>
            </div>
            
            <div class="menu-section">
                <h3 class="menu-header">ENTITY MANAGEMENT</h3>
                <button class="menu-button" onclick="showAllEntities()">View All Entities</button>
                <button class="menu-button" onclick="showCreateEntity()">Create Entity</button>
                <button class="menu-button" onclick="showKnowledgeEditor()">Knowledge Entity Editor</button>
                <button class="menu-button" onclick="showEntityRelationships()">Entity Relationships</button>
            </div>
            
            <div class="menu-section">
                <h3 class="menu-header">WORLD BUILDING</h3>
                <button class="menu-button" onclick="showLocationsManager()">Locations Manager</button>
                <button class="menu-button" onclick="showObjectsDatabase()">Objects Database</button>
                <button class="menu-button" onclick="showKnowledgeDomains()">Knowledge Domains</button>
                <button class="menu-button" onclick="showKnowledgeItems()">Knowledge Items</button>
            </div>
            
            <div class="menu-section">
                <h3 class="menu-header">NARRATIVE SYSTEM</h3>
                <button class="menu-button" onclick="showStoryArcs()">Story Arcs Manager</button>
                <button class="menu-button" onclick="showNarrativeSegments()">Narrative Segments</button>
                <button class="menu-button" onclick="showNarrativePaths()">Narrative Paths</button>
                <button class="menu-button" onclick="showCharacterStoryAssign()">Character-Story Assignment</button>
            </div>
            
            <div class="menu-section">
                <h3 class="menu-header">EVENTS SYSTEM</h3>
                <button class="menu-button" onclick="showMultiverseEvents()">Multiverse Events Log</button>
                <button class="menu-button" onclick="showPsychicEvents()">Psychic Events Monitor</button>
                <button class="menu-button" onclick="showOmiyageEvents()">Omiyage (Gift) Events</button>
                <button class="menu-button" onclick="showCreateEvent()">Create New Event</button>
            </div>
            
            <div class="menu-section">
                <h3 class="menu-header">USER & SYSTEM</h3>
                <button class="menu-button" onclick="showUserManagement()">User Management</button>
                <button class="menu-button" onclick="showSystemSettings()">System Settings</button>
                <button class="menu-button" onclick="showDatabaseHealth()">Database Health</button>
                <button class="menu-button" onclick="showHexMonitor()">Hex ID Monitor</button>
            </div>
        </div>
    `;
};

// ===== Character Management =====

window.loadCharacterList = async () => {
    try {
        const response = await fetch("/api/cms/characters");
        const data = await response.json();

        if (data.success) {
            const listContainer = document.getElementById("character-list-container");

            listContainer.innerHTML = data.characters.map(char => `
                <div class="character-item" onclick="showCharacter('${char.character_id}')">
                    <div class="character-name">${char.character_name}</div>
                    <div class="character-category">${char.category || 'Unknown'}</div>
                </div>
            `).join("") + `
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #00ff75;">
                    <button class="menu-button" onclick="showAdminMenu()">Return To Main Menu</button>
                </div>
            `;

            document.getElementById("top-right-window-inner").innerHTML = `
                <div class="success-message">
                    <h2>âœ“ Characters Loaded</h2>
                    <p>Loaded ${data.count} characters</p>
                </div>
            `;
        }

    } catch (err) {
        console.error("Error:", err);
    }
};

window.showCreateCharacter = () => {
    const display = document.getElementById("top-right-window-inner");
    display.innerHTML = `<div class="admin-content"><h2>Create New Character</h2></div>`;
};

// ===== Entity Manager Buttons (LIVE WIRED) =====

window.showAllEntities = () => EntityManager.showAllEntities();
window.showCreateEntity = () => EntityManager.showCreateEntity();
window.showKnowledgeEditor = () => EntityManager.showKnowledgeEditor();
window.showEntityRelationships = () =>
    EntityManager.manageRelationshipsSelector
        ? EntityManager.manageRelationshipsSelector()
        : EntityManager.showAllEntities();

// ===== System Buttons =====

window.showUserManagement = () => {
    document.getElementById('top-right-window-inner').innerHTML =
        '<div class="admin-content"><h2>User Management</h2></div>';
};

window.showSystemSettings = () => {
    document.getElementById('top-right-window-inner').innerHTML =
        '<div class="admin-content"><h2>System Settings</h2></div>';
};

window.showDatabaseHealth = () => {
    document.getElementById('top-right-window-inner').innerHTML =
        '<div class="admin-content"><h2>Database Health</h2></div>';
};

window.showHexMonitor = () => {
    document.getElementById('top-right-window-inner').innerHTML =
        '<div class="admin-content"><h2>Hex ID Monitor</h2></div>';
};

